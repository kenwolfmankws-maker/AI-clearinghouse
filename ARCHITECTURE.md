# AI Clearinghouse Architecture Report
**Generated by MASTERBUILDER | December 16, 2025**
**Updated with Boundary Enforcement | December 20, 2025**

## Executive Summary

The AI Clearinghouse project has a **clear architectural separation** between two distinct domains with **strict boundary enforcement**:

1. **AI Clearinghouse Entry Portal** (root `/`) - **PROFESSIONAL/NEUTRAL DOMAIN**
2. **Wolfman's Cosmic Cowboy Porch** (`/porch`) - **SANCTUARY/MYTHIC DOMAIN**

This separation ensures each experience maintains its unique identity while sharing backend infrastructure. **Boundary enforcement is automated** to preserve the intentional separation of mythic and professional domains.

---

## Domain Architecture

### üõ°Ô∏è Boundary Enforcement System

**Purpose:** Protect architectural boundaries and preserve intentional separation of domains under the authority of MASTERBUILDER GEORGE.

**Key Principle:** Sanctuary is sacred. Separation is intentional. Boundaries must hold.

#### Domain Definitions

**SANCTUARY (Sacred/Mythic Domain)**
- **Nature:** Mythic, symbolic, narrative, philosophical
- **NOT:** Marketplace, product UI, generic assistant
- **Includes:**
  - The Porch (`/porch/`) - Wolfman's Cosmic Cowboy Porch
  - Eldon (Gatekeeper persona) - SANCTUARY-ONLY
  - Future symbolic spaces (The Forge, Mirror of Wisdom)
  - Algo-Rhythm (implicit pulse, never exposed)
- **Characteristics:**
  - Mythic persona and voice
  - Symbolic language and metaphors
  - Cowboy/cosmic aesthetic
  - Narrative-driven interactions
  - Philosophical depth

**AI CLEARINGHOUSE (Neutral/Professional Domain)**
- **Nature:** Professional, utilitarian, neutral
- **Includes:**
  - Root entry portal (`/index.html`)
  - Chat API (`/api/chat.js`) - uses generic guide, NOT Eldon
  - Shared infrastructure (`/lib/`, `/scripts/`)
- **Characteristics:**
  - Professional tone
  - Neutral language
  - Utilitarian design
  - NO mythic persona
  - NO cowboy voice

#### Non-Negotiable Rules

1. **SANCTUARY IS SACRED**
   - Never neutralize, flatten, or professionalize Sanctuary elements
   - Protected from corporate language, professional redesigns, generic behavior

2. **ELDON IS SANCTUARY-ONLY**
   - Eldon MUST NEVER appear in: Clearinghouse, marketplaces, neutral assistants, professional contexts
   - Eldon is a gatekeeper, not a concierge
   - If relocated, must be preserved intact in Sanctuary

3. **SEPARATION OF CONCERNS IS REQUIRED**
   - Preserve elements elsewhere OR get explicit permission before deletion
   - NEVER erase symbolic systems without relocation plans

4. **SECURITY FIXES DO NOT JUSTIFY SCOPE EXPANSION**
   - Security remediation must be surgical
   - Does NOT authorize: UI redesigns, persona removal, philosophical changes, system prompt normalization

5. **DEFAULT BEHAVIOR: STOP AND ASK**
   - If intent is ambiguous: STOP, ASK, DO NOT ASSUME

#### Automated Enforcement

**Pre-commit Hook** (`scripts/boundary-check.cjs`):
- Checks for Eldon in Clearinghouse contexts (BLOCKS commit)
- Checks for mythic language in Clearinghouse (warns)
- Checks for professional language in Sanctuary (warns)
- Checks for symbolic element deletion (BLOCKS commit)

**Boundary Enforcer Agent** (`.github/agents/boundary-enforcer.agent.md`):
- Activates on PRs affecting Sanctuary or Clearinghouse
- Scans for boundary violations
- Flags neutralization attempts
- Requires explicit approval for symbolic deletions

**Eldon Agent** (`.github/agents/eldon.agent.md`):
- Enforces Sanctuary-only usage of Eldon persona
- Blocks Eldon usage in non-Sanctuary contexts
- Assists with relocation when needed

**MasterBuilder George** (`.github/agents/masterbuilder-george.agent.md`):
- Updated to respect boundary enforcement rules
- Must preserve mythic elements during repairs
- Cannot neutralize Sanctuary or inject mythic into Clearinghouse

---

## Current Architecture

### üè† Root Experience: AI Clearinghouse Entry Portal

**Purpose:** Gateway hub for multiple AI portals and experiences.

**Implementation:**
- **Production:** `/index.html` (served by Vercel at root)
- **Local Dev:** `/index.html` (served by `local-server.cjs` at `http://localhost:3000/`)
- **Features:**
  - Portal navigation grid with cards for each experience
  - Direct chat interface with Eldon (OpenAI integration)
  - Expandable design for future portals
  - Clear visual hierarchy with gradient backgrounds and glow effects

**Key Components:**
- Embedded inline CSS with theme matching project aesthetics
- Inline JavaScript for chat functionality
- Links to `/porch` for Cosmic Cowboy experience
- Placeholder cards for future portals (Signal Hub, Lab Station)

**Status:** ‚úÖ **ACTIVE** ‚Äì Fully implemented as of this report

---

### üåå Porch Experience: Wolfman's Cosmic Cowboy Porch

**Purpose:** Standalone immersive chat environment with cosmic/western theming.

**Implementation:**
- **Production:** `/porch/index.html` (Vercel rewrite rule in `vercel.json`)
- **Local Dev:** `http://localhost:3000/porch` (Express static middleware)
- **Features:**
  - Animated starfield background (CSS keyframes)
  - Cowboy-themed local chat responses (fallback, no API)
  - Immersive dark cosmic aesthetic
  - Self-contained with dedicated styles and scripts

**Key Components:**
- `/porch/index.html` ‚Äì Entry point
- `/porch/style.css` ‚Äì Cosmic styling with starfield animations
- `/porch/script.js` ‚Äì Starfield spawner + local cowboy chat logic

**Status:** ‚úÖ **ACTIVE & UNCHANGED** ‚Äì No modifications made per MASTERBUILDER constraints

---

## Routing Configuration

### Vercel (Production)

Configured in `vercel.json`:
```json
{
  "rewrites": [
    {
      "source": "/porch",
      "destination": "/porch/index.html"
    }
  ]
}
```

- Root (`/`) ‚Üí `/index.html` (Clearinghouse Entry Portal)
- `/porch` ‚Üí `/porch/index.html` (Cosmic Cowboy Porch)
- API routes ‚Üí `/api/chat.js` (serverless function)

### Local Development

Configured in `local-server.cjs`:
```javascript
app.use('/porch', express.static(path.join(__dirname, 'porch')));
app.get('/', (req, res) => {
  res.sendFile(path.join(__dirname, 'index.html'));
});
```

- `http://localhost:3000/` ‚Üí Root Clearinghouse Entry Portal
- `http://localhost:3000/porch` ‚Üí Cosmic Cowboy Porch
- `http://localhost:3000/api/chat` ‚Üí OpenAI chat endpoint

---

## Legacy and Deprecated Files

### ‚ö†Ô∏è `/public/index.html`

**Status:** LEGACY ‚Äì Local dev testing only

This file was previously used as a local development interface but has been superseded by the root `index.html`. It has been updated with clear comments indicating its legacy status.

**Purpose Now:** Minimal fallback for local testing scenarios only.

**Action Required:** Consider removing in future cleanup if no longer needed.

---

## What Was Created

### New Root Portal Experience (`/index.html`)

**Before:** Generic "AI Clearinghouse" chat interface without navigation or clear purpose.

**After:** Comprehensive portal hub with:
- Hero header explaining the Clearinghouse mission
- Portal navigation grid (3 cards: Porch active, 2 planned)
- Inline quick-chat interface with Eldon
- Footer branding
- Responsive design with hover effects
- Theme consistency (dark gradients, cyan/blue accents)
- TODO comments for future expansion points

**Design Principles Applied:**
- Clarity over cleverness ‚úì
- No frameworks introduced ‚úì
- Inline styles/scripts for simplicity ‚úì
- Labeled expansion points with TODO comments ‚úì

---

## What Was Left Intentionally Empty

### Placeholder Portal Cards

Two portal cards in the navigation grid are marked as "COMING SOON" / "PLANNED":

1. **üì° Signal Hub** ‚Äì Real-time AI coordination center
2. **üî¨ Lab Station** ‚Äì Model experimentation interface

These are **intentionally non-functional** placeholders with:
- Dashed borders
- Reduced opacity (50%)
- `cursor: default` to indicate non-clickable state
- Status badges indicating development stage

**Purpose:** Communicate roadmap and future expansion without promising immediate functionality.

---

## Verification Checklist

‚úÖ Root (`/`) renders Clearinghouse Entry Portal  
‚úÖ `/porch` renders Cosmic Cowboy Porch (unchanged)  
‚úÖ Vercel routing configuration preserved  
‚úÖ Local server routing updated with clarity  
‚úÖ No Porch scripts or styles modified  
‚úÖ No frameworks introduced  
‚úÖ TODO comments added for future expansion  
‚úÖ Legacy files clearly marked  

---

## Deployment Domains

Both experiences are accessible via:
- `https://aiclearinghouse.ai` (root and `/porch`)
- `https://ai-clearinghouse.vercel.app` (root and `/porch`)

Vercel automatically handles routing per `vercel.json` configuration.

---

## Recommendations for Future Work

1. **Remove `/public/index.html`** after confirming no dependencies
2. **Implement Signal Hub** portal with real-time monitoring
3. **Implement Lab Station** portal for model experimentation
4. **Add navigation breadcrumbs** to Porch to return to Clearinghouse
5. **Consider shared component library** if portal count exceeds 5
6. **Add analytics** to track portal usage patterns
7. **Create consistent branding footer** across all portals

---

## File Manifest

### Active Production Files
- `/index.html` ‚Äì Clearinghouse Entry Portal (root)
- `/porch/index.html` ‚Äì Cosmic Cowboy Porch entry
- `/porch/style.css` ‚Äì Porch styling (unchanged)
- `/porch/script.js` ‚Äì Porch logic (unchanged)
- `/api/chat.js` ‚Äì OpenAI serverless endpoint
- `/local-server.cjs` ‚Äì Express server for local dev
- `/vercel.json` ‚Äì Vercel routing configuration

### Legacy/Dev-Only Files
- `/public/index.html` ‚Äì Legacy local dev interface (marked)
- `/public/style.css` ‚Äì Legacy styles
- `/public/chat-frontend.js` ‚Äì Legacy chat script

### Shared Infrastructure
- `/lib/oidc.js` ‚Äì JWT verification (not portal-specific)
- `/scripts/*` ‚Äì CLI utilities and tooling
- `/.github/workflows/*` ‚Äì CI/CD automation

---

## Conclusion

The AI Clearinghouse now has a **distinct architectural identity** separate from the Porch experience. The root portal serves as a navigation hub and expansion point, while the Porch remains a self-contained immersive environment. Routing works consistently across local development and production deployments.

**All objectives completed successfully.**

---

*End of Architecture Report*
