---
description: Rules for Resend email integration in this project
globs:
  - "api/contact.js"
---

# Resend Email Integration Rules

## Required: Use the Resend Node.js SDK

Always import and instantiate the Resend SDK. **Never** call the Resend REST API
directly via `fetch` or any other HTTP client.

```js
// CORRECT
import { Resend } from "resend";
const resend = new Resend(process.env.RESEND_API_KEY);

// WRONG – do not do this
const response = await fetch("https://api.resend.com/emails", { ... });
```

## Required: Read the API key from environment

Always use `process.env.RESEND_API_KEY`. Never hardcode the key.

```js
// CORRECT
const resend = new Resend(process.env.RESEND_API_KEY);

// WRONG
const resend = new Resend("re_abc123...");
```

## Required: Use the { data, error } destructuring pattern

The SDK's `resend.emails.send()` returns `{ data, error }`. Always destructure
and check `error` before using `data`.

```js
// CORRECT
const { data, error } = await resend.emails.send({ ... });
if (error) {
  return res.status(502).json({ error: "Failed to send message" });
}
return res.status(200).json({ ok: true, id: data.id });

// WRONG – do not inspect HTTP responses manually
const response = await fetch(...);
if (!response.ok) { ... }
```

## Checklist before merging any email-related PR

- [ ] Uses `import { Resend } from "resend"` (SDK, not fetch)
- [ ] API key read from `process.env.RESEND_API_KEY` only
- [ ] `{ data, error }` destructuring from `resend.emails.send()`
- [ ] `error` checked before using `data`
- [ ] No secrets hardcoded anywhere
